# tsdiff

![test](https://github.com/<YOUR_GITHUB_ID>/robosys2025/actions/workflows/test.yml/badge.svg)

`tsdiff` は、**行頭がタイムスタンプ（秒）であるログ**を標準入力から読み取り、  
**直前行からの差分時間 Δt（秒）** を付加して標準出力へ出力するフィルタコマンドです。

---

## 何ができるか

- ログの **イベント間隔（遅延）** を見やすくする
- センサ周期や処理の詰まり（間隔が伸びる箇所）を見つける
- 他のコマンドと **パイプで自由に接続** して解析できる

---

## 使い方

入力は **1行1レコード** で、  
各行の **先頭が数値（秒）** である必要があります。  
空行は無視されます。

```bash
$ printf "0 a\n1 b\n3 c\n" | ./tsdiff
0  0 a
1  1 b
2  3 c
```
出力の 第1列: 直前行との差分時間 Δt（秒）

第2列以降: 元の入力行

パイプで自由に接続できる理由

tsdiff は、

標準入力（stdin）からのみ入力を受け取る

標準出力（stdout）にのみ結果を出力する

余計なメッセージを出力しない

という UNIXフィルタとしての設計 を採用しています。

そのため、前後の処理を固定せず、既存のコマンドと
|（パイプ）で自由に接続できます。

例
```bash
# ファイルを流し込む
$ cat log.txt | ./tsdiff

# Δt が 1秒を超える行だけ抽出
$ cat log.txt | ./tsdiff | awk '$1 > 1.0'

# 生成したデータにもそのまま適用
$ seq 5 | awk '{print $1, "event"}' | ./tsdiff
```
エラー時の挙動

入力が空（空行のみ）の場合

標準エラー出力に no input

終了ステータス: 1

行頭が数値でない行が含まれる場合

標準エラー出力にエラー内容

終了ステータス: 1

正常終了

終了ステータス: 0

※ エラーメッセージは 標準エラー出力 に出力されるため、
パイプ処理のデータ（標準出力）を汚しません。

必要なソフトウェア

Python 3

テスト
```bash
$ ./test.bash
OK
```
GitHub Actions により、push をトリガとして
複数の Python バージョンで自動テストが実行されます。

ライセンス

BSD 3-Clause License
(SPDX-License-Identifier: BSD-3-Clause)

© 2026 Ryusei Abe
