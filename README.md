# tsdiff

![test](https://github.com/Nitrio-o/robosys2025/actions/workflows/test.yml/badge.svg)

## 概要

tsdiff は、**行頭がタイムスタンプ（秒）であるログ**を標準入力から読み取り、直前行との差分時間 Δt（秒）を付加して標準出力へ出力するフィルタコマンドです。

UNIX の標準入出力モデルに基づき設計されており、他のコマンドとパイプで接続して使用できます。

## 提供するコマンド

- tsdiff

## 機能

- 行頭のタイムスタンプ（秒）を用いて差分時間 Δt を計算
- 各行の先頭に Δt を付加して出力
- 元の入力行の内容は保持

## 入出力仕様

### 標準入力（stdin）

- 1行1レコードのテキスト
- 各行の先頭が数値（秒）であること
- 空行は無視される

### 標準出力（stdout）

- 各行の先頭に差分時間 Δt（秒）を付加したテキスト

### 標準エラー出力（stderr）

- エラー発生時のメッセージを出力

## 使用例

```bash
$ printf "0 a\n1 b\n3 c\n" | ./tsdiff
0  0 a
1  1 b
2  3 c
```

- 第1列: 直前行との差分時間 Δt（秒）
- 第2列以降: 元の入力行

## エラー時の挙動

### 入力が空（空行のみ）の場合

- 標準エラー出力に `no input`
- 終了ステータス: 1

### 行頭が数値でない行が含まれる場合

- 標準エラー出力にエラー内容を出力
- 終了ステータス: 1

### 正常終了時

- 終了ステータス: 0

※ エラーメッセージは標準エラー出力に出力されるため、標準出力はパイプ処理で安全に利用できます。

## 動作環境

- Ubuntu 24.04 LTS
- Python 3.7–3.10

## テスト

本リポジトリには自動テストが含まれており、GitHub Actions により以下を確認しています。

- 正常入力に対して正しい Δt が出力されること
- 異常入力時に適切な終了ステータスを返すこと
- 複数の Python バージョンで動作すること

```bash
$ ./test.bash
OK
```

## ライセンス

本ソフトウェアは BSD 3-Clause License の下で公開されています。詳細は LICENSE ファイルを参照してください。

## 謝辞

本ソフトウェアは、千葉工業大学「ロボットシステム学」の講義資料を参考に作成しました。

© 2026 Ryusei Abe
